{"version":3,"file":"main.js","sources":["../../src/js/retencao.js","../../src/js/themeToggle.js","../../src/js/observar.js","../../src/js/modal_checkout.js","../../src/js/gtm.js","../../src/js/components/cookies.js","../../src/js/main.js"],"sourcesContent":["export function configurarRetencao() {\n    const modal = document.getElementById('modal-retencao');\n    const btnFicar = document.getElementById('btn-ficar');\n    const btnSair = document.getElementById('btn-sair');\n    \n    let isModalOpen = false;\n\n    const ativarRetencao = () => {\n        // Se já tem a trava no histórico, não faz nada\n        if (window.history.state?.trava) return;\n\n        // Cria o estado virtual \"trava\"\n        window.history.pushState({ trava: true }, \"\");\n        console.log(\"Sistema de retenção pronto.\");\n\n        window.onpopstate = (event) => {\n            // Se o usuário tentou voltar e o modal não está aberto\n            if (!isModalOpen) {\n                isModalOpen = true;\n                modal.style.display = 'flex';\n\n                // Importante: Empurramos o estado de novo para o modal \"prender\" o usuário\n                // Mas sem disparar o onpopstate novamente\n                window.history.pushState({ trava: true }, \"\");\n            }\n        };\n    };\n\n  btnFicar.onclick = () => {\n    modal.style.display = 'none';\n    const msg = encodeURIComponent(\"Vim pela página de Elite e quero meu Diagnóstico de Escala. Estou cansado do operacional.\");\n    window.open(`https://wa.me/5511999999999?text=${msg}`, '_blank');\n};\n\n    btnSair.onclick = () => {\n        isModalOpen = false;\n        modal.style.display = 'none';\n        window.onpopstate = null; // Mata a função de interceptar\n        \n        // Volta dois níveis: o da trava e o da página anterior real\n        window.history.go(-2); \n    };\n\n    document.addEventListener('click', ativarRetencao, { once: true });\n    document.addEventListener('scroll', ativarRetencao, { once: true });\n}","  export default function themeToggle() {\n     const themeToggle = document.getElementById('theme-toggle');\n        themeToggle.addEventListener('click', () => {\n            // Verificamos se o tema atual é light\n            const isLight = document.documentElement.getAttribute('data-theme') === 'light';\n            \n            if (isLight) {\n                // Mudar para Dark\n                document.documentElement.setAttribute('data-theme', 'dark');\n                localStorage.setItem('theme', 'dark');\n            } else {\n                // Mudar para Light\n                document.documentElement.setAttribute('data-theme', 'light');\n                localStorage.setItem('theme', 'light');\n            }\n        });\n  }\n  \n ","export default function observer(){\n    const observerOptions = {\n    root: null,\n    rootMargin: \"0px\",\n    threshold: 0.1      // Dispara IMEDIATAMENTE ao detectar o elemento\n};\n\nconst observer = new IntersectionObserver((entries) => {\n    entries.forEach(entry => {\n        const target = entry.target;\n        \n        if (entry.isIntersecting) {\n            // Usa requestAnimationFrame para não travar a Main Thread\n            requestAnimationFrame(() => {\n                target.classList.add('active');\n                target.classList.add('animate');\n            });\n\n            if (target.classList.contains('reveal')) {\n                observer.unobserve(target);\n            }\n        } else {\n            // Evita remover classes de seções que já passaram se não for estritamente necessário\n            if (!target.classList.contains('reveal')) {// se der erro remova\n                requestAnimationFrame(() => {\n                    target.classList.remove('active');\n                });\n            }\n        }\n    });\n}, observerOptions);\n\n// Registra todos os alvos\ndocument.querySelectorAll('.reveal, header, section, footer').forEach(el => {\n    observer.observe(el);\n});        \n\n}\n\n","export default  function modal_checkout() {\n       // 1. SELEÇÃO DE ELEMENTOS\n    const modal = document.getElementById(\"modal-compra\");\n    const btnTrigger = document.getElementById(\"quero-ser-elite\");\n    const btnClose = document.querySelector(\".modal__close\");\n    const btnCheckout = document.querySelector(\".btn-checkout\");\n    const btnIcon = document.getElementById(\"btn-icon-treinamento\")\n    const cta_faq = document.getElementById(\"cta_faq\")\n    const btn_hero__button = document.getElementById(\"btn_hero__button\")\n    const offer_mockup=document.getElementById(\"offer_mockup\")\n    const quero=document.getElementById(\"quero-ser-elite\")\n    \n\n    // 2. FUNÇÃO DE PERFORMANCE (CARREGAMENTO DINÂMICO)\n    const loadExternalScript = (src) => {\n        return new Promise((resolve, reject) => {\n            // Se o script já existir, resolve imediatamente\n            if (document.querySelector(`script[src=\"${src}\"]`)) return resolve();\n            \n            const script = document.createElement('script');\n            script.src = src;\n            script.async = true; // Não trava o carregamento\n            script.onload = resolve;\n            script.onerror = reject;\n            document.head.appendChild(script);\n        });\n    };\n\n    // 3. FUNÇÕES DE CONTROLE DO MODAL\n    const abrirModal = (e) => {\n        e.preventDefault();\n        modal.style.display = \"flex\";\n        document.body.style.overflow = \"hidden\"; // Trava scroll do fundo\n        \n        // Pré-carrega o SDK assim que o modal abre para ganhar tempo\n        loadExternalScript(\"https://sdk.mercadopago.com/js/v2\")\n            .catch(err => console.error(\"Erro ao pré-carregar SDK\", err));\n    };\n\n    const fecharModal = () => {\n        modal.style.display = \"none\";\n        document.body.style.overflow = \"auto\"; // Devolve scroll\n    };\n\n    // 4. LÓGICA DO CHECKOUT (SIMULAÇÃO API)\n    const handleCheckout = async () => {\n        // Feedback visual imediato\n        btnCheckout.innerHTML = `<span class=\"spinner\"></span> PROCESSANDO...`;\n        btnCheckout.style.pointerEvents = \"none\";\n\n        try {\n            // Garante que o SDK está disponível\n            await loadExternalScript(\"https://sdk.mercadopago.com/js/v2\");\n\n            // Simula o tempo de resposta da API\n            setTimeout(() => {\n                const overlay = document.createElement('div');\n                overlay.className = 'api-simulada-overlay';\n                overlay.innerHTML = `\n                    <div class=\"api-simulada-content\">\n                        <img src=\"https://img.icons8.com/color/96/mercado-pago.png\" alt=\"Mercado Pago\">\n                        <h3>Ambiente de Demonstração</h3>\n                        <p>A API do Mercado Pago foi carregada com sucesso via script dinâmico para garantir <strong>Performance Máxima (Core Web Vitals)</strong>.</p>\n                        <div class=\"status-badge\">DEVELOPER MODE: ONLINE</div>\n                        <button onclick=\"this.parentElement.parentElement.remove()\" class=\"btn-close-api\">VOLTAR AO PROJETO</button>\n                    </div>\n                `;\n                document.body.appendChild(overlay);\n\n                // Reset do botão\n                btnCheckout.innerHTML = \"FINALIZAR INSCRIÇÃO AGORA\";\n                btnCheckout.style.pointerEvents = \"all\";\n            }, 1500);\n\n        } catch (error) {\n            btnCheckout.innerHTML = \"ERRO NA CONEXÃO\";\n            btnCheckout.style.pointerEvents = \"all\";\n        }\n    };\n\n    // 5. EVENT LISTENERS\n    if (offer_mockup) offer_mockup.addEventListener(\"click\", focus);\n    if (btnTrigger) btnTrigger.addEventListener(\"click\", abrirModal);\n    if (cta_faq) cta_faq.addEventListener(\"click\", abrirModal);\n    if (btn_hero__button) btn_hero__button.addEventListener(\"click\", abrirModal);\n    if (btnIcon) btnIcon.addEventListener(\"click\", abrirModal);\n    if (btnClose) btnClose.addEventListener(\"click\", fecharModal);\n    if (btnCheckout) btnCheckout.addEventListener(\"click\", handleCheckout);\n    \n    //Focus\n    function focus(){\n        offer_mockup.style.opacity = .5;\n        quero.focus()\n    }\n\n    // Fechar ao clicar fora ou ESC\n    window.addEventListener(\"click\", (e) => { if (e.target === modal) fecharModal(); });\n    document.addEventListener(\"keydown\", (e) => { if (e.key === \"Escape\") fecharModal(); });\n}","export default function gtm(){\n    // Chamada do GTM (Apenas a lógica interna, sem as tags <script>)\n    (function(w,d,s,l,i){\n        w[l]=w[l]||[];\n        w[l].push({'gtm.start': new Date().getTime(), event:'gtm.js'});\n        var f=d.getElementsByTagName(s)[0],\n            j=d.createElement(s),\n            dl=l!='dataLayer'?'&l='+l:'';\n        j.async=true;\n        j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;\n        f.parentNode.insertBefore(j,f);\n    })(window, document, 'script', 'dataLayer', 'GTM-KFT4K58W');\n\n    console.log(\"GTM carregado em tempo ocioso para manter Performance 100.\");\n}\n\n\n","export default function initCookies() {\n    const banner = document.getElementById('cookie-banner');\n    const btnAccept = document.getElementById('cookie-accept');\n\n    // 1. Verifica se o usuário já aceitou antes\n    if (localStorage.getItem('cookies-aceitos')) return;\n\n    // 2. Só mostra o banner quando o navegador estiver livre (Idle)\n        window.requestIdleCallback(() => {\n            setTimeout(() => banner.classList.add('active'), 3000);\n        });\n    \n        window.addEventListener('load', () => {\n            setTimeout(() => banner.classList.add('active'), 4000);\n        });\n    \n\n    // 3. Ação de aceitar\n    btnAccept.addEventListener('click', () => {\n        banner.classList.remove('active');\n        localStorage.setItem('cookies-aceitos', 'true');\n        \n        // Aqui você pode disparar um evento para o GTM avisando que foi aceito\n        window.dataLayer = window.dataLayer || [];\n        window.dataLayer.push({'event': 'cookie_consent_accepted'});\n    });\n}","import '../scss/style.scss';\n\n// 2. Importa o CSS Crítico APENAS em ambiente de desenvolvimento\nif (import.meta.env.DEV) {\n  import('../scss/critical.scss');\n}\n\n// Importamos as funções de outros arquivos (o Vite vai unir tudo)\nimport { configurarRetencao } from './retencao.js';\nimport themeToggle from './themeToggle.js';\nimport observar from './observar.js';\nimport modal_checkout from './modal_checkout.js';\nimport monitor_inp from './monitor_inp.js';\nimport gtm from './gtm.js';\nimport cookies from \"./components/cookies\";\n\nwindow.addEventListener('load', () => {\n    // 1. O que é visual e imediato (Banner e Monitor)\n    cookies();\n    \n\n    // 2. Tarefas de Funcionalidade (Essenciais, mas podem esperar o ócio)\n    const tarefasFuncionais = [\n        () => themeToggle(),\n        () => modal_checkout(),\n        () => observar(),\n        () => configurarRetencao()\n    ];\n\n    // 3. Tarefa de Marketing (A mais pesada - GTM)\n    // Vamos isolar para rodar por último\n    const carregarMarketing = () => {\n        if ('requestIdleCallback' in window) {\n            // \"Ociosidade dentro da ociosidade\" com delay de 2s\n            requestIdleCallback(() => {\n                setTimeout(() => gtm(), 2000); \n            });\n        } else {\n            setTimeout(() => gtm(), 4000);\n        }\n    };\n\n    const processarFila = (deadline) => {\n        while (deadline.timeRemaining() > 1 && tarefasFuncionais.length > 0) {\n            const tarefa = tarefasFuncionais.shift();\n            tarefa();\n        }\n\n        if (tarefasFuncionais.length > 0) {\n            requestIdleCallback(processarFila);\n        } else {\n            // Quando a fila funcional zerar, agendamos o GTM\n            console.log(\"⚡ Sistemas funcionais prontos. Agendando Marketing...\");\n            carregarMarketing();\n        }\n    };\n\n    // Início do fluxo\n    if ('requestIdleCallback' in window) {\n        requestIdleCallback(processarFila, { timeout: 3000 });\n    } else {\n        // Fallback para Safari\n        const fallback = () => {\n            if (tarefasFuncionais.length > 0) {\n                (tarefasFuncionais.shift())();\n                setTimeout(fallback, 100);\n            } else {\n                carregarMarketing();\n            }\n        };\n        setTimeout(fallback, 200);\n    }\n});"],"names":["configurarRetencao","modal","btnFicar","btnSair","isModalOpen","ativarRetencao","event","msg","themeToggle","observer","observerOptions","entries","entry","target","el","modal_checkout","btnTrigger","btnClose","btnCheckout","btnIcon","cta_faq","btn_hero__button","offer_mockup","quero","loadExternalScript","src","resolve","reject","script","abrirModal","e","err","fecharModal","handleCheckout","overlay","focus","gtm","w","d","s","l","i","f","j","dl","initCookies","banner","btnAccept","cookies","tarefasFuncionais","observar","carregarMarketing","processarFila","deadline","fallback"],"mappings":"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"}